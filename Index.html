<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Laporan Shift A</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 16px; background: #f2f2f2; max-width: 600px; margin: auto; }
    input, textarea, button {
      width: 100%; padding: 10px; margin-top: 10px; font-size: 14px;
      border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box;
    }
    button { font-weight: bold; border: none; color: white; cursor: pointer; }
    #generateBtn { background: #28a745; }
    #waBtn { background: #25d366; }
    #gptBtn { background: #007bff; }
    pre {
      background: #fff; padding: 12px; border-radius: 5px; border: 1px solid #ccc;
      white-space: pre-wrap; font-family: monospace;
    }
  </style>
</head>
<body>

<h2>Laporan Shift A</h2>
<input type="date" id="tanggal">
<input id="produk" placeholder="Produk">

<h3>üîß GRINDING</h3>
<input id="psa" placeholder="Ukuran PSA / Partikel (contoh: 30‚Äì50)">
<input id="mesh" placeholder="Mesh">
<input id="mix_a" placeholder="Mix A">
<input id="mix_b" placeholder="Mix B">
<input id="silo_a" placeholder="Silo A">
<input id="silo_b" placeholder="Silo B">
<textarea id="catatan_grinding" placeholder="Catatan Grinding..."></textarea>

<h3>üì¶ PREPARATION</h3>
<input type="number" id="pulp203" placeholder="Pulp Tangki 203 (set)">
<input type="number" id="pulp204" placeholder="Pulp Tangki 204 (set)">
<input type="number" id="pulp205" placeholder="Pulp Tangki 205 (set)">
<input type="number" id="adhesive_standby" placeholder="Adhesive Standby (set)">
<input type="number" id="adhesive_sisa" placeholder="Adhesive Sisa di Tangki (set)">
<input type="number" id="flavor_standby" placeholder="Flavor Standby (set)">
<input type="number" id="flavor_sisa" placeholder="Flavor Sisa di Tangki (set)">
<input type="number" id="kalsium" placeholder="Kalsium Standby (set)">
<input id="recycle" placeholder="Recycle (mis. 3 set √ó 20 kg = 60 kg)">
<textarea id="catatan_preparation" placeholder="Catatan Preparation..."></textarea>

<h3>üì¶ FINISH GOOD</h3>
<input type="number" id="mr" placeholder="Jumlah Mother Roll (roll)">
<input type="number" id="fg_berat" placeholder="Total Berat (kg)">
<textarea id="catatan_finish" placeholder="Catatan Finish Good..."></textarea>

<h3>üõ† CYLINDER</h3>
<input id="pisau" placeholder="Pisau Nomor">
<textarea id="catatan_cylinder" placeholder="Catatan Cylinder..."></textarea>

<h3>‚úÇÔ∏è SLITTING</h3>
<input type="number" id="slit_mr" placeholder="Jumlah MR yang dipotong">
<input type="number" id="reject_produksi" placeholder="Bobin Reject Produksi">
<input type="number" id="reject_ncp" placeholder="Bobin Reject NCP">
<input type="number" id="total_bobin_manual" placeholder="Total Bobin Keseluruhan (manual)">
<textarea id="catatan_slitting" placeholder="Catatan Slitting..."></textarea>

<button id="generateBtn" onclick="generate()">Tampilkan Laporan</button>
<pre id="output"></pre>
<button id="waBtn" onclick="kirimWhatsApp()">Kirim ke WhatsApp</button>
<button id="gptBtn" onclick="kirimKeChatGPT()">Kirim ke ChatGPT</button>

<script>
function g(id) { return document.getElementById(id).value.trim(); }
function n(id) { return parseInt(g(id)) || 0; }

function buatCatatan(teks) {
  if (!teks) return "";
  return teks.split("\n").map(l => "- " + l).join("\n");
}

function generate() {
  const totalBobinManual = n("total_bobin_manual");
  const totalBobinKg = totalBobinManual * 15;

  const bobin_mr = n("slit_mr");
  const total_bobin = bobin_mr * 10;
  const reject = n("reject_produksi");
  const reject_ncp = n("reject_ncp");
  const bobin_oke = total_bobin - reject - reject_ncp;
  const bobin_oke_kg = bobin_oke * 15;

  const oee = (bobin_oke_kg / (10.2 * 1.09 * 0.22 * 480)) * 100;

  let hasil = "";
  hasil += `LAPORAN SHIFT A\n`;
  if (g("tanggal")) hasil += `Tanggal: ${g("tanggal")}\n`;
  if (g("produk")) hasil += `Produk: ${g("produk")}\n\n`;

  // Grinding
  hasil += `üîß GRINDING\n`;
  if (g("psa")) hasil += `- Ukuran PSA / Partikel: ${g("psa")} ¬µm\n`;
  if (g("mesh")) hasil += `- Mesh: ${g("mesh")}\n`;
  if (g("mix_a")) hasil += `- Mix A: ${g("mix_a")}\n`;
  if (g("mix_b")) hasil += `- Mix B: ${g("mix_b")}\n`;
  if (g("silo_a")) hasil += `- Silo A: ${g("silo_a")}\n`;
  if (g("silo_b")) hasil += `- Silo B: ${g("silo_b")}\n`;
  if (g("catatan_grinding")) hasil += buatCatatan(g("catatan_grinding")) + "\n";
  hasil += `\n`;

  // Preparation
  hasil += `üì¶ PREPARATION\n`;
  if (g("pulp203")) hasil += `- Pulp Tangki 203: ${g("pulp203")} set\n`;
  if (g("pulp204")) hasil += `- Pulp Tangki 204: ${g("pulp204")} set\n`;
  if (g("pulp205")) hasil += `- Pulp Tangki 205: ${g("pulp205")} set\n`;
  if (g("adhesive_standby")) hasil += `- Adhesive Standby: ${g("adhesive_standby")} set\n`;
  if (g("adhesive_sisa")) hasil += `- Adhesive Sisa di Tangki: ${g("adhesive_sisa")} set\n`;
  if (g("flavor_standby")) hasil += `- Flavor Standby: ${g("flavor_standby")} set\n`;
  if (g("flavor_sisa")) hasil += `- Flavor Sisa di Tangki: ${g("flavor_sisa")} set\n`;
  if (g("kalsium")) hasil += `- Kalsium Standby: ${g("kalsium")} set\n`;
  if (g("recycle")) hasil += `- Recycle: ${g("recycle")}\n`;
  if (g("catatan_preparation")) hasil += buatCatatan(g("catatan_preparation")) + "\n";
  hasil += `\n`;

  // Finish Good
  hasil += `üì¶ FINISH GOOD\n`;
  if (g("mr")) hasil += `- Jumlah Mother Roll: ${g("mr")} roll\n`;
  if (g("fg_berat")) hasil += `- Total Berat: ${g("fg_berat")} kg\n`;
  if (g("catatan_finish")) hasil += buatCatatan(g("catatan_finish")) + "\n";
  hasil += `\n`;

  // Cylinder
  hasil += `üõ† CYLINDER\n`;
  if (g("pisau")) hasil += `- Pisau Nomor: ${g("pisau")}\n`;
  if (g("catatan_cylinder")) hasil += buatCatatan(g("catatan_cylinder")) + "\n";
  hasil += `\n`;

  // Slitting
  hasil += `‚úÇÔ∏è SLITTING\n`;
  if (bobin_mr) hasil += `- Slitting potong: ${bobin_mr} MR = ${total_bobin} bobin\n`;
  if (reject) hasil += `- Bobin Reject Produksi: ${reject} bobin, total ${reject * 15} kg\n`;
  if (reject_ncp) hasil += `- Bobin Reject NCP: ${reject_ncp} bobin, total ${reject_ncp * 15} kg\n`;
  if (bobin_mr) hasil += `- Bobin yang oke: ${bobin_oke} bobin, total ${bobin_oke_kg} kg\n`;
  if (totalBobinManual) hasil += `- Total Bobin Keseluruhan: ${totalBobinManual} bobin (${totalBobinKg} kg)\n`;
  if (g("catatan_slitting")) hasil += buatCatatan(g("catatan_slitting")) + "\n";
  hasil += `\n`;

  // OEE
  if (!isNaN(oee)) {
    hasil += `üìà OEE\n`;
    hasil += `- Hasil OEE: ${oee.toFixed(2)}%\n`;
  }

  document.getElementById("output").textContent = hasil;
}

function kirimWhatsApp() {
  const isi = document.getElementById("output").textContent;
  if (isi) {
    const url = "https://wa.me/?text=" + encodeURIComponent(isi);
    window.open(url, "_blank");
  }
}

function kirimKeChatGPT() {
  const isi = document.getElementById("output").textContent;
  if (isi) {
    const prompt = "Perbaiki kalimat ini menjadi lebih baik:\\n\\n" + isi;
    const url = "https://chat.openai.com/chat?model=gpt-4&message=" + encodeURIComponent(prompt);
    window.open(url, "_blank");
  }
}
</script>

</body>
</html>